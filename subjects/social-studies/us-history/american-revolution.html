<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>American Revolution | U.S. History | Teach Arcade</title>

  <!-- Global styles -->
  <link rel="stylesheet" href="/assets/styles.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Nunito:wght@400;600&display=swap" rel="stylesheet"/>
  <link rel="icon" type="image/png" href="/assets/images/teach-arcade-logo.png"/>

  <meta name="description" content="Free American Revolution resources: lesson plans, worksheets, primary sources, videos, and activities for high school U.S. History."/>

  <style>
    /* Ensure content sits below sticky header (fallback if stylesheet misses it) */
    :root { --header-h: 64px; }
    @media (min-width: 821px){ :root { --header-h: 72px; } }
    body { padding-top: var(--header-h); }

    /* Lightweight styles just for Topic Explorer */
    .tabs {
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      background:#f1f5f9; border:1px solid #e5e7eb; border-radius:12px;
      padding:10px; margin:18px 0 16px;
    }
    .tab {
      appearance:none; border:1px solid #cbd5e1; background:#fff; color:#1f2937;
      padding:8px 12px; border-radius:999px; cursor:pointer; font:600 14px/1 Poppins, sans-serif;
    }
    .tab[aria-selected="true"] { background:#2563eb; color:#fff; border-color:#2563eb; }
    .pill {
      display:inline-block; padding:4px 8px; border-radius:999px; font:600 12px/1 Nunito, sans-serif;
      background:#eef2ff; color:#3730a3; margin-right:6px;
    }
    .pill.gray { background:#f1f5f9; color:#334155; }
    .pill.green{ background:#ecfdf5; color:#065f46; }
    .pill.orange{ background:#fff7ed; color:#9a3412; }
    .pill.blue{ background:#eff6ff; color:#1d4ed8; }
    .filters-row { display:flex; gap:10px; align-items:center; margin:12px 0 8px; }
    .filters-row input[type="search"]{
      flex:1; min-width:220px; padding:10px 12px; border:1px solid #cbd5e1; border-radius:10px;
    }
    #resource-list.card-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:16px; }
    .card h3 { margin:0 0 8px; }
    .meta { margin:0 0 12px; color:#475569; font:600 13px/1.4 Nunito, sans-serif; }
  </style>
</head>
<body>
  <!-- Reusable header mounts here on every page -->
  <div id="site-header"></div>
  <script src="/assets/scripts/nav.js" defer></script>

  <main class="container">
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <a href="/">Home</a> â€º
      <a href="/subjects/index.html">Subjects</a> â€º
      <a href="/subjects/social-studies/index.html">Social Studies</a> â€º
      <a href="/subjects/social-studies/us-history/index.html">U.S. History</a> â€º
      American Revolution
    </nav>

    <h1>American Revolution</h1>
    <p>Curated lessons, worksheets, primary sources, videos, and activities.</p>

    <!-- Filters: Search -->
    <div class="filters-row">
      <input id="searchInput" type="search" placeholder="Search titlesâ€¦" aria-label="Search resources">
    </div>

    <!-- Topic Explorer tabs (auto-populated) -->
    <div id="tabs" class="tabs" role="tablist" aria-label="Resource categories"></div>

    <!-- Resources render here -->
    <section id="resource-list" class="card-grid" aria-live="polite"></section>
  </main>

  <footer>
    Â© <script>document.write(new Date().getFullYear())</script> Teach Arcade â€¢
    <a href="/privacy.html">Privacy</a> â€¢
    <a href="/terms.html">Terms</a>
  </footer>

  <!-- Page logic: load & render resources -->
  <script>
    // â¬‡ï¸ EDIT THESE TWO ONLY â¬‡ï¸
    const SHEET_ID   = "1dPJAi0dKjP6hWpgpNlA2M-2INar75-LxJ-fKEJjWslc"; // Public copy ID
    const SHEET_NAME = "American Revolution";                             // Exact tab name
    // â¬†ï¸ EDIT THESE TWO ONLY â¬†ï¸

    const SHEET_URL =
      `https://docs.google.com/spreadsheets/d/${encodeURIComponent(SHEET_ID)}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;

    const listEl   = document.getElementById("resource-list");
    const tabsEl   = document.getElementById("tabs");
    const searchEl = document.getElementById("searchInput");

    const CATEGORY_BUCKETS = [
      { key: "worksheets",      label: "Worksheets",      includes: ["worksheet","handout","practice"] },
      { key: "lessons",         label: "Lessons",         includes: ["lesson","teacher guide","unit","plan"] },
      { key: "primary-sources", label: "Primary Sources", includes: ["primary","document","source"] },
      { key: "games",           label: "Games",           includes: ["game","interactive","simulation"] },
      { key: "videos",          label: "Videos",          includes: ["video","film"] },
      { key: "assessments",     label: "Assessments",     includes: ["quiz","assessment","test"] },
      { key: "presentations",   label: "Presentations",   includes: ["presentation","slides"] },
      { key: "projects",        label: "Projects",        includes: ["project","performance","inquiry"] },
      { key: "other",           label: "Other",           includes: [] }
    ];

    let allRows = [];
    let activeTab = "all";

    const safeStr = v => (v == null ? "" : String(v));
    const toUrl = u => {
      const s = safeStr(u).trim();
      return s ? (/^https?:\/\//i.test(s) ? s : "https://" + s) : "";
    };

    function bucketFor(category){
      const cat = safeStr(category).toLowerCase();
      for (const b of CATEGORY_BUCKETS) if (b.includes.some(t => cat.includes(t))) return b.key;
      return "other";
    }

    function iconFor(item){
      const t=item.type.toLowerCase(), c=item.category.toLowerCase();
      if (t.includes("pdf")) return "ðŸ“„";
      if (c.includes("game")||c.includes("interactive")) return "ðŸŽ®";
      if (t.includes("video")||c.includes("video")) return "ðŸŽ¥";
      if (c.includes("primary")) return "ðŸ“œ";
      if (c.includes("lesson")||c.includes("guide")) return "ðŸ“˜";
      return "ðŸ”—";
    }

    function badgeClass(bucket){
      switch(bucket){
        case "games": return "pill green";
        case "videos": return "pill blue";
        case "lessons": return "pill orange";
        case "worksheets": return "pill gray";
        case "primary-sources": return "pill";
        default: return "pill gray";
      }
    }

    function cardHTML(item){
      const bucket=bucketFor(item.category), icon=iconFor(item);
      const meta = [
        `<span class="${badgeClass(bucket)}">${CATEGORY_BUCKETS.find(b=>b.key===bucket)?.label||"Other"}</span>`,
        item.type ? `<span class="pill gray">${safeStr(item.type)}</span>` : ""
      ].filter(Boolean).join(" ");
      return `
        <div class="card">
          <div style="font-size:24px;margin-bottom:4px;">${icon}</div>
          <h3 style="margin:0 0 8px;">${safeStr(item.title)}</h3>
          <p class="meta">${meta}</p>
          ${item.url ? `<a class="cta" href="${item.url}" target="_blank" rel="noopener noreferrer">View Resource</a>` : ""}
        </div>`;
    }

    function buildTabs(rows){
      const set = new Set(rows.map(r => bucketFor(r.category)));
      const available = CATEGORY_BUCKETS.filter(b => set.has(b.key));
      const parts = [`<button class="tab" role="tab" data-tab="all" aria-selected="${activeTab==="all"}">All</button>`];
      for (const b of available) parts.push(`<button class="tab" role="tab" data-tab="${b.key}" aria-selected="${activeTab===b.key}">${b.label}</button>`);
      tabsEl.innerHTML = parts.join("");
      tabsEl.querySelectorAll(".tab").forEach(btn => {
        btn.addEventListener("click", () => {
          tabsEl.querySelectorAll(".tab").forEach(x => x.setAttribute("aria-selected","false"));
          btn.setAttribute("aria-selected","true");
          activeTab = btn.dataset.tab;
          render();
        });
      });
    }

    function render(){
      const q = safeStr(searchEl.value).toLowerCase().trim();
      const filtered = allRows.filter(r => {
        if (activeTab!=="all" && bucketFor(r.category)!==activeTab) return false;
        return !q || r.title.toLowerCase().includes(q) || r.category.toLowerCase().includes(q);
      });
      listEl.innerHTML = filtered.length ? filtered.map(cardHTML).join("")
        : `<div class="card" style="grid-column:1/-1;">No matching resources yet.</div>`;
    }

    async function loadResources(){
      listEl.innerHTML = `<div class="card" style="grid-column:1/-1;">Loading resourcesâ€¦</div>`;
      try{
        const res = await fetch(SHEET_URL,{cache:"no-store"});
        const text = await res.text();
        const start=text.indexOf('{'), end=text.lastIndexOf('}');
        if (start===-1 || end===-1) throw new Error("Unexpected GViz format");
        const json = JSON.parse(text.slice(start,end+1));
        const rawRows = Array.isArray(json?.table?.rows) ? json.table.rows : [];
        allRows = rawRows.map(r => r?.c || []).map(c => ({
          title: safeStr(c[0]?.v),
          type: safeStr(c[1]?.v),
          category: safeStr(c[2]?.v),
          url: toUrl(c[3]?.v)
        })).filter(r => r.title && r.title.toLowerCase()!=="title" && r.url);
        buildTabs(allRows); render();
      }catch(err){
        console.error("Sheet load error:", err);
        listEl.innerHTML = `<div class="card" style="grid-column:1/-1;color:#b91c1c;">
          Couldn't load resources. Check the public sheet ID, tab name, or sharing.
        </div>`;
      }
    }

    searchEl.addEventListener("input", render);
    loadResources();
  </script>
</body>
</html>
